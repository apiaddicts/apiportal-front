<!doctype html>
<html lang="es" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-a3innuva-nómina/como-empezar/OAuth">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Autenticación OAuth 2.0 | Wolters Kluwer | developers</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://a3developershelp.wolterskluwer.es/docusaurus/docs/a3innuva-nómina/como-empezar/OAuth"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Autenticación OAuth 2.0 | Wolters Kluwer | developers"><meta data-rh="true" name="description" content="OAuth 2.0 es un protocolo que permite a tu aplicación acceder a los datos de la cuenta de un usuario sin acceder a su contraseña. Para poder realizar peticiones a la API necesitarás, aparte de la Subscription Key del portal a3developer, un token de acceso que generará la WKA al autenticar el usuario."><meta data-rh="true" property="og:description" content="OAuth 2.0 es un protocolo que permite a tu aplicación acceder a los datos de la cuenta de un usuario sin acceder a su contraseña. Para poder realizar peticiones a la API necesitarás, aparte de la Subscription Key del portal a3developer, un token de acceso que generará la WKA al autenticar el usuario."><link data-rh="true" rel="icon" href="/docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://a3developershelp.wolterskluwer.es/docusaurus/docs/a3innuva-nómina/como-empezar/OAuth"><link data-rh="true" rel="alternate" href="https://a3developershelp.wolterskluwer.es/docusaurus/docs/a3innuva-nómina/como-empezar/OAuth" hreflang="es"><link data-rh="true" rel="alternate" href="https://a3developershelp.wolterskluwer.es/docusaurus/docs/a3innuva-nómina/como-empezar/OAuth" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/docusaurus/blog/rss.xml" title="Wolters Kluwer | developers RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus/blog/atom.xml" title="Wolters Kluwer | developers Atom Feed">







<script src="https://app.happyreact.com/widget/reactions.js" defer="defer"></script><link rel="stylesheet" href="/docusaurus/assets/css/styles.6a41d605.css">
<link rel="preload" href="/docusaurus/assets/js/runtime~main.c80b8365.js" as="script">
<link rel="preload" href="/docusaurus/assets/js/main.7ad6548e.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus/"><div class="navbar__logo"><img src="/docusaurus/img/WK_F_Pos@x2.png" alt="a3developers Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docusaurus/img/WK_F_Pos@x2.png" alt="a3developers Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">a3developers Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus/docs/intro">Documentación</a><a class="navbar__item navbar__link" href="/docusaurus/blog">Blog</a><a href="https://a3developers.wolterskluwer.es/products/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Suscripciones<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://a3developers.wolterskluwer.es/app-partners" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">App Partners<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://a3marketplace.wolterskluwer.es/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Aplicaciones<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus/docs/intro">Bienvenido a las APIs de Wolters Kluwer</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docusaurus/docs/a3innuva-nómina/como-empezar/">a3innuva | nómina</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docusaurus/docs/a3innuva-nómina/como-empezar/">Cómo empezar</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cómo empezar&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/a3innuva-nómina/como-empezar/cuenta-a3developer">Cuenta a3developer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/a3innuva-nómina/como-empezar/wolters-kluwer-account">Wolters Kluwer Account</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus/docs/a3innuva-nómina/como-empezar/OAuth">Autenticación OAuth 2.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/a3innuva-nómina/como-empezar/problemas-frecuentes">Problemas más frecuentes</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docusaurus/docs/category/características-técnicas">Características técnicas</a><button aria-label="Toggle the collapsible sidebar category &#x27;Características técnicas&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docusaurus/docs/category/api-reference">API Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;API Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">a3innuva | nómina</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docusaurus/docs/a3innuva-nómina/como-empezar/"><span itemprop="name">Cómo empezar</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Autenticación OAuth 2.0</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">En esta página</button></div><div class="theme-doc-markdown markdown"><h1>Autenticación OAuth 2.0</h1><p><strong><a href="https://oauth.net/2/" target="_blank" rel="noopener noreferrer">OAuth 2.0</a></strong> es un protocolo que permite a tu aplicación acceder a los datos de la cuenta de un usuario sin acceder a su contraseña. Para poder realizar peticiones a la API necesitarás, aparte de la <em>Subscription Key</em> del portal a3developer, un token de acceso que generará la WKA al autenticar el usuario.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Atención</div><div class="admonitionContent_S0QG"><p>Para poder obtener el token es necesario disponer de un <strong>client OAuth</strong> personalizado por cada cliente de <strong>a3innuva | nómina</strong> y es un proceso que actualmente gestionamos internamente desde Wolters Kluwer. Si no dispones de un client OAuth, por favor, completa el siguiente <a href="https://forms.office.com/r/8h9FA4K5Lr" target="_blank" rel="noopener noreferrer">formulario</a> para que podamos proporcionártelo.</p></div></div><p>Implementamos un flujo de autenticación <i>Híbrido-Authorization Code</i>, que es el que se utiliza habitualmente para aplicaciones web. Es importante que tu aplicación web mantenga seguros los credenciales de autenticación (<code>client_id</code> y <code>client_secret</code>)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="endpoints">Endpoints<a class="hash-link" href="#endpoints" title="Enlace directo al encabezado">​</a></h2><table><thead><tr><th></th><th>Endpoint</th></tr></thead><tbody><tr><td>Autorización</td><td><code>https://login.wolterskluwer.eu/auth/core/connect/authorize</code></td></tr><tr><td>Request token</td><td><code>https://login.wolterskluwer.eu/auth/core/connect/token</code></td></tr><tr><td>Refresh token</td><td><code>https://login.wolterskluwer.eu/auth/core/connect/token</code></td></tr></tbody></table><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Atención</div><div class="admonitionContent_S0QG"><p>La comunicación con el sistema de WKA deberá ser mediante TLS 1.2 o superior.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flujo-de-autenticación">Flujo de autenticación<a class="hash-link" href="#flujo-de-autenticación" title="Enlace directo al encabezado">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-redirige-al-usuario-para-autorizar-tu-aplicación">1. Redirige al usuario para autorizar tu aplicación<a class="hash-link" href="#1-redirige-al-usuario-para-autorizar-tu-aplicación" title="Enlace directo al encabezado">​</a></h3><p>Tu aplicación debe dirigir a los usuarios a la siguiente URL: </p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://login.wolterskluwer.eu/auth/core/connect/authorize?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client_id=YOUR_CLIENT_ID&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response_type=code+id_token&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response_mode=fragment&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redirect_uri=YOUR_REDIRECT_URI&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scope=offline_access+openid+IDInfo+WK.ES.A3EquipoContex&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state=GUID&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nonce=GUID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Los siguientes valores se deben de pasar como parámetro:</p><ul><li><strong>client_id</strong>: es el client_id del client OAuth que te hemos proporcionado. Por ejemplo: <code>
WK.ES.A3WebApi.A23456</code></li><li><strong>response_type</strong>: <strong>code+id_token</strong></li><li><strong>response_mode</strong>: <strong>fragment</strong></li><li><strong>redirect_uri</strong>: la URL en tu servidor para redirigir de vuelta: esta debe ser una dirección <code>https</code>, sin embargo, para probar puedes usar <code>http://localhost:53971/Login/CallbackFromWKA</code> o <code>http://oob/oauth20_desktop.srf</code> si es una aplicación de escritorio. Ten en cuenta que no se puede usar <code>http://127.0.0.1</code> Si necesitas agregar una nueva <code>redirect_uri</code> recuerda que debes hacer la petición a través de este <a href="https://forms.office.com/r/8h9FA4K5Lr" target="_blank" rel="noopener noreferrer">formulario</a>.</li><li><strong>scope</strong>: <strong>offline_access+openid+IDInfo+WK.ES.A3EquipoContex</strong></li><li><strong>state</strong>: es un texto que debe usarse para evitar ataques de falsificación. Informa un valor único para cada llamada (por ejemplo, un <code>GUID</code>) que se devolverá como parámetro en la llamada a tu <code>redirect_uri</code>. Deberás validar que el valor enviado coincide con el recibido.</li><li><strong>nonce</strong>: el objetivo de este parámetro es parecido al del <code>state</code> salvo que este valor se incluirá dentro del <code>id_token</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-llamada-al-punto-de-autorización-del-wka-auth-server">2. Llamada al punto de autorización del WKA Auth Server<a class="hash-link" href="#2-llamada-al-punto-de-autorización-del-wka-auth-server" title="Enlace directo al encabezado">​</a></h3><p>Tu sitio web deberá lanzar una petición GET con la url construida según el punto anterior. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-wka-auth-server-muestra-una-pantalla-de-login">3. WKA Auth Server muestra una pantalla de login<a class="hash-link" href="#3-wka-auth-server-muestra-una-pantalla-de-login" title="Enlace directo al encabezado">​</a></h3><p>Si la url está bien construida y la petición es correcta, nuestro servidor de autenticación mostrará una pantalla de login para que el usuario informe sus credenciales de la WKA.
<img loading="lazy" alt="LoginWKA" src="/docusaurus/assets/images/Login_WKA-d776bdb7218eaf125d5e4e7c35d40d78.PNG" width="919" height="811" class="img_ev3q"></p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Importante!</div><div class="admonitionContent_S0QG"><p>Recuerda que los credenciales de la WKA no tienen porqué ser los mismos que los del portal a3developer. Son las credenciales con las que normalmente accede el usuario a su aplicación <b>a3innuva | nómina</b></p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-el-usuario-informa-sus-credenciales">4. El usuario informa sus credenciales<a class="hash-link" href="#4-el-usuario-informa-sus-credenciales" title="Enlace directo al encabezado">​</a></h3><p>Si el usuario de WKA tiene acceso a varias empresas (tenants), se le mostrará un formulario donde deberá seleccionar qué conjunto de recursos quiere exponer:</p><p><img loading="lazy" alt="LoginWKAIDCA" src="/docusaurus/assets/images/Login_IDCDA-3c60c8bc64c962f52cf446ba8c0cd5e2.PNG" width="979" height="586" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-autorización">5. Autorización<a class="hash-link" href="#5-autorización" title="Enlace directo al encabezado">​</a></h3><p>El servidor de autorización de WKA validará los credenciales informados, y si son correctos, enviará una petición <code>GET</code> a la <code>return_uri</code> con los parámetros:</p><ul><li><strong>code</strong>: un código temporal que solo se puede canjear una vez y caduca 5 minutos después de su emisión. Revisa el siguiente punto donde se detalla cómo usarlo.</li><li><strong>id_token</strong>: es un <a href="https://es.wikipedia.org/wiki/JSON_Web_Token" target="_blank" rel="noopener noreferrer">JWT Token</a> que contiene información de identificación. <strong>No es el token de acceso a la aplicación</strong>. Está cifrado con <a href="https://es.wikipedia.org/wiki/SHA-2" target="_blank" rel="noopener noreferrer">SHA-256</a> y en el <i>payload</i> puedes revisar información acerca de la identidad y de seguridad (por ejemplo, el valor <code>nonce</code> para contrastarlo con el que has enviado).</li><li><strong>state</strong>: si el <code>state</code> no coincide con el enviado, la solicitud puede haber sido creada por un tercero y debes cancelar el proceso.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-intercambiar-el-authorization-code">6. Intercambiar el Authorization Code<a class="hash-link" href="#6-intercambiar-el-authorization-code" title="Enlace directo al encabezado">​</a></h3><p>Ahora ya puedes obtener el <code>access_token</code> utilizando el <code>code</code> que te ha proporcionado el WKA Auth Server. Para realizar este paso, deberás enviar una petición <code>POST</code> al endpoint:</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://login.wolterskluwer.eu/auth/core/connect/token</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Esta petición requiere de unos parámetros en el <code>header</code>:</p><ul><li><strong>client_id</strong>: es el identificador de tu cliente OAuth. Por ejemplo <code>WK.ES.A3WebApi.A23456</code></li><li><strong>client_secret</strong>: es la clave secreta de tu cliente OAuth. Por ejemplo <code>NvPqSESxR9JKr6Te</code></li><li><strong>code</strong>: el <code>code</code> que has obtenido en el paso anterior.</li><li><strong>grant_type</strong>: <strong>authorization_code</strong></li><li><strong>redirect_uri</strong>: la misma uri que has informado en el proceso de autorización</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --location --request POST </span><span class="token string" style="color:#e3116c">&#x27;https://login.wolterskluwer.eu/auth/core/connect/token&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header </span><span class="token string" style="color:#e3116c">&#x27;Content-Type: application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;client_id=YOUR_CLIENT_ID&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;client_secret=YOUR_CLIENT_SECRET&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;code=YOUR_AUTHORIZATION_CODE&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;grant_type=authorization_code&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;redirect_uri=YOUR_REDIRECT_URI&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="7--el-servidor-wka-auth-devuelve-el-access_token">7.  El servidor WKA Auth devuelve el access_token<a class="hash-link" href="#7--el-servidor-wka-auth-devuelve-el-access_token" title="Enlace directo al encabezado">​</a></h3><p>El servidor WKA Auth verificará todos los parámetros en la solicitud, asegurándose de que el código no haya caducado y que la identificación del cliente y el secreto coincidan. Si todo sale bien, generará tus tokens y los devolverá en la respuesta, que contendrá los siguientes valores:</p><ul><li><strong>access_token</strong>: JWT token necesario para poder hacer las llamadas a la <strong>API a3innuva | laboral</strong></li><li><strong>id_token</strong>: JWT token con datos de la identidad del usuario.</li><li><strong>expires_in</strong>: tiempo en segundos hasta que el token expire. Por defecto son 60 minutos.</li><li><strong>token_type</strong>: <strong>Bearer</strong></li><li><strong>refresh_token</strong>: Es el token que se puede utilizar para refrescar el <code>access_token</code> una vez haya expirado. Por defecto tiene una caducidad de 30 días.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="contenido-del-access-token">Contenido del access-token<a class="hash-link" href="#contenido-del-access-token" title="Enlace directo al encabezado">​</a></h4><p>El <code>access-token</code> es un JSON web token (JWT) que se puede decodificar en un objeto JSON y contiene información sobre el usuario y la autenticación realizada.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;$id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;iss&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://login.wolterskluwercloud.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;aud&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://login.wolterskluwercloud.com/resources&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;exp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1668712060</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;nbf&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1668708460</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;client_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WK.ES.A3WebApi.A23456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;scope&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;offline_access&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;openid&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;IDInfo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;WK.ES.A3EquipoContex&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;sub&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;d6d396d5-4bfe-4fcd-9f2a-ab76007854a5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;auth_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1668707536</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;idp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;idsrv&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;wk.es.clientid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;23456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;wk.es.idcda&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1M8Q2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;wk.es.a3equipouserid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a3developers@wolterskluwer.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;wk.es.secondclientid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;65432&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;usr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;9cff49af-1b13-4964-9291-ad8d0cb047a9&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;owapp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;53335e0c-a116-44f5-b525-aa4400ada916&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;mem&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;9cff49cf-1b23-4334-2191-aa8800b04779&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;oun&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;82bffb8f-4b0b-4065-ac27-aba600f09952&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;amr&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>El campo <code>exp</code> hace referencia a la fecha de expiración del <code>access_token</code> en formato <a href="https://www.rfc-editor.org/rfc/rfc3339" target="_blank" rel="noopener noreferrer">EPOCH</a></p><p>Necesitarás validar que el JWT está correctamente firmado y verificar que la información que contiene es correcta. En <a href="https://jwt.io/libraries" target="_blank" rel="noopener noreferrer">esta página</a> puedes ver un conjunto de librerías por lenguaje de programación, indicando para cada una qué claims se verifican.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Atención</div><div class="admonitionContent_S0QG"><p>El tiempo de expiración del access_token es de 1 hora. </p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-llamada-a-la-api">8. Llamada a la API<a class="hash-link" href="#8-llamada-a-la-api" title="Enlace directo al encabezado">​</a></h3><p>Ahora ya puedes hacer llamadas a la <strong>API a3innuva | laboral</strong> añadiendo al <code>header</code>de tu petición las siguientes variables:</p><ul><li><strong>Authorization</strong>: &quot;Bearer &quot; + access_token</li><li><strong>Ocp-Apim-Subscription-Key</strong>: clave principal de tu suscripción del portal a3developer.</li></ul><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /Laboral/api/companies?pageNumber=1&amp;pageSize=25&amp;filter=lastUpdate gt 2022-01-01&amp;OrderBy=companyCode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authorization: Bearer eyIkaWQiOiIxIiwidHlwIjoiSld...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ocp-Apim-Subscription-Key: 2kxwf5rb7ffb65dd5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-respuesta-de-la-api">9. Respuesta de la API<a class="hash-link" href="#9-respuesta-de-la-api" title="Enlace directo al encabezado">​</a></h3><p>Si la <code>Ocp-Apim-Subscription-Key</code> y el <code>acces_token</code> son válidos, la API devolverá la información en formato json:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;companyCode&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;companyName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EMPRESA TEST&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;identifierNumber&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;E2133833T&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lastUpdate&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2022-06-30T11:22:59.563Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-refresco-del-access_token-y-refresh_token">10. Refresco del access_token y refresh_token<a class="hash-link" href="#10-refresco-del-access_token-y-refresh_token" title="Enlace directo al encabezado">​</a></h3><p>Los tokens de acceso caducan después de 60 minutos. Tu aplicación puede actualizar un token de acceso sin la interacción del usuario mediante un <code>refresh_token</code>, que se obtiene en el paso 7 y tiene una caducidad de 30 días. Durante estos 30 días podrás generar nuevos <code>access-token</code>  sin necesidad de que el usuario ingrese de nuevo sus credenciales. </p><p>Para refrescar el <code>access-token</code> deberás enviar una petición POST al <code>token endpoint</code>:</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://login.wolterskluwer.eu/auth/core/connect/token</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Esta petición requiere de unos parámetros en el <code>header</code>:</p><ul><li><strong>client_id</strong>: es el identificador de tu cliente OAuth. Por ejemplo <code>
WK.ES.A3WebApi.A23456</code></li><li><strong>client_secret</strong>: es la clave secreta de tu cliente OAuth. Por ejemplo <code>NvPqSESxR9JKr6Te</code></li><li><strong>grant_type</strong>: <strong>refresh_token</strong></li><li><strong>refresh_token</strong>: el <code>refresh-token</code> que has obtenido en el punto 7.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --location --request POST </span><span class="token string" style="color:#e3116c">&#x27;https://login.wolterskluwer.eu/auth/core/connect/token&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header </span><span class="token string" style="color:#e3116c">&#x27;Content-Type: application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;client_id=YOUR_CLIENT_ID&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;client_secret=YOUR_CLIENT_SECRET&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;grant_type=refresh_token&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-urlencode </span><span class="token string" style="color:#e3116c">&#x27;refresh_token=YOUR_REFRESH_TOKEN&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11--el-servidor-wka-auth-devuelve-el-access_token-refrescado">11.  El servidor WKA Auth devuelve el access_token refrescado<a class="hash-link" href="#11--el-servidor-wka-auth-devuelve-el-access_token-refrescado" title="Enlace directo al encabezado">​</a></h3><p>Si la validación del <code>access_token</code> es correcta, el servidor WKA Auth generará tus tokens y los devolverá en la respuesta, que contendrá los siguientes valores:</p><ul><li><strong>access_token</strong>: nuevo JWT token necesario para poder hacer las llamadas a la <strong>API a3innuva | laboral</strong></li><li><strong>id_token</strong>: JWT token con datos de la identidad del usuario.</li><li><strong>expires_in</strong>: tiempo en segundos hasta que el token expire. Por defecto son 60 minutos.</li><li><strong>token_type</strong>: <strong>Bearer</strong></li><li><strong>refresh_token</strong>: Nuevo <code>refresh_token</code>. Dependiendo de la configuración del client OAuth, es posible que sea diferente al <code>refresh_token</code> previo. Deberás guardar en lugar seguro este token para poder utilizarlo más adelante.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Navegación de páginas de documentos"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus/docs/a3innuva-nómina/como-empezar/wolters-kluwer-account"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">Wolters Kluwer Account</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus/docs/a3innuva-nómina/como-empezar/problemas-frecuentes"><div class="pagination-nav__sublabel">Siguiente</div><div class="pagination-nav__label">Problemas más frecuentes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#endpoints" class="table-of-contents__link toc-highlight">Endpoints</a></li><li><a href="#flujo-de-autenticación" class="table-of-contents__link toc-highlight">Flujo de autenticación</a><ul><li><a href="#1-redirige-al-usuario-para-autorizar-tu-aplicación" class="table-of-contents__link toc-highlight">1. Redirige al usuario para autorizar tu aplicación</a></li><li><a href="#2-llamada-al-punto-de-autorización-del-wka-auth-server" class="table-of-contents__link toc-highlight">2. Llamada al punto de autorización del WKA Auth Server</a></li><li><a href="#3-wka-auth-server-muestra-una-pantalla-de-login" class="table-of-contents__link toc-highlight">3. WKA Auth Server muestra una pantalla de login</a></li><li><a href="#4-el-usuario-informa-sus-credenciales" class="table-of-contents__link toc-highlight">4. El usuario informa sus credenciales</a></li><li><a href="#5-autorización" class="table-of-contents__link toc-highlight">5. Autorización</a></li><li><a href="#6-intercambiar-el-authorization-code" class="table-of-contents__link toc-highlight">6. Intercambiar el Authorization Code</a></li><li><a href="#7--el-servidor-wka-auth-devuelve-el-access_token" class="table-of-contents__link toc-highlight">7.  El servidor WKA Auth devuelve el access_token</a></li><li><a href="#8-llamada-a-la-api" class="table-of-contents__link toc-highlight">8. Llamada a la API</a></li><li><a href="#9-respuesta-de-la-api" class="table-of-contents__link toc-highlight">9. Respuesta de la API</a></li><li><a href="#10-refresco-del-access_token-y-refresh_token" class="table-of-contents__link toc-highlight">10. Refresco del access_token y refresh_token</a></li><li><a href="#11--el-servidor-wka-auth-devuelve-el-access_token-refrescado" class="table-of-contents__link toc-highlight">11.  El servidor WKA Auth devuelve el access_token refrescado</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Knowledge Base</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus/docs/intro">Documentación</a></li><li class="footer__item"><a class="footer__link-item" href="/docusaurus/docs/intro">API Reference</a></li><li class="footer__item"><a href="https://a3developers.wolterskluwer.es/" target="_blank" rel="noopener noreferrer" class="footer__link-item">a3developers Portal<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built for developers by developers | © Wolters Kluwer</div></div></div></footer></div>
<script src="/docusaurus/assets/js/runtime~main.c80b8365.js"></script>
<script src="/docusaurus/assets/js/main.7ad6548e.js"></script>
</body>
</html>